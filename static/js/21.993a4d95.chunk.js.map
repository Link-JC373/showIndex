{"version":3,"sources":["pages/admin/components/systemData/pieChart.js","pages/admin/components/systemData/histogram.tsx","pages/admin/components/systemData/index.tsx","utils/request.ts"],"names":["PieChart","props","pieData","useEffect","console","log","pie","Chart","container","autoFit","height","coordinate","radius","data","scale","formatter","val","tooltip","showTitle","showMarkers","interval","position","color","label","content","item","percent","adjust","interaction","render","id","style","width","Histogram","chart","nice","useState","setPieData","histogramData","setHGData","req","Request","initPieData","a","get","then","res","initHGData","post","times","className","length","Service","axios","create","timeout","baseURL","interceptors","request","use","config","url","indexOf","headers","token","localStorage","getItem","error","Promise","reject","response","status","confirm","title","onOk","removeItem","window","location","reload","resolve","result"],"mappings":"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","file":"static/js/21.993a4d95.chunk.js","sourcesContent":["import React, { useEffect } from 'react';\r\nimport { Chart } from '@antv/g2';\r\n\r\nconst PieChart = (props) => {\r\n    const { pieData } = props\r\n\r\n    useEffect(() => {\r\n        console.log(pieData);\r\n\r\n        const pie = new Chart({\r\n            container: 'pieCanvas',\r\n            autoFit: true,\r\n            height: 500,\r\n        });\r\n\r\n        pie.coordinate('theta', {\r\n            radius: 0.75,\r\n        });\r\n        pie.data(pieData);\r\n\r\n        pie.scale('percent', {\r\n            formatter: (val) => {\r\n                val = val * 100 + '%';\r\n                return val;\r\n            },\r\n        });\r\n\r\n        pie.tooltip({\r\n            showTitle: false,\r\n            showMarkers: false,\r\n        });\r\n\r\n        pie\r\n            .interval()\r\n            .position('percent')\r\n            .color('item')\r\n            .label('percent', {\r\n                content: (data) => {\r\n                    return `${data.item}: ${data.percent * 100}%`;\r\n                },\r\n            })\r\n            .adjust('stack');\r\n\r\n        pie.interaction('element-active');\r\n\r\n        pie.render();\r\n    }, [pieData])\r\n\r\n\r\n    return (\r\n\r\n        <div id='pieCanvas' style={{ width: 400, height: 300 }}>\r\n        </div>\r\n\r\n    )\r\n}\r\n\r\nexport default PieChart;","import React, { useEffect } from 'react';\r\nimport { Chart } from '@antv/g2';\r\n\r\nconst Histogram = (props: any) => {\r\n\r\n    useEffect(() => {\r\n        const { data } = props\r\n        const chart = new Chart({\r\n            container: 'hg',\r\n            autoFit: true,\r\n            height: 500,\r\n        });\r\n\r\n        chart.data(data);\r\n        chart.scale('sales', {\r\n            nice: true,\r\n        });\r\n\r\n        chart.tooltip({\r\n            showMarkers: false\r\n        });\r\n        chart.interaction('active-region');\r\n\r\n        chart.interval().position('time*sales');\r\n\r\n        chart.render();\r\n    })\r\n\r\n    return (\r\n        <div id='hg' style={{ width: 400, height: 300 }}></div>\r\n    );\r\n}\r\n\r\nexport default Histogram;","import React, { useState, useEffect } from 'react';\r\nimport PieChart from './pieChart';\r\nimport Histogram from './histogram';\r\nimport './index.scss'\r\nimport Request from '../../../../utils/request';\r\ninterface iPieData {\r\n\r\n    item: string,\r\n    count: number,\r\n    percent: number\r\n\r\n}\r\ninterface iHGData {\r\n    sales: number,\r\n    time: string,\r\n}\r\n\r\nconst Chart = () => {\r\n\r\n    const [pieData, setPieData] = useState<Array<iPieData>>([])\r\n    const [histogramData, setHGData] = useState<Array<iHGData>>([])\r\n    let req = new Request()\r\n\r\n    const initPieData = async () => {\r\n        await req.get('admin/getPieData').then(res => {\r\n            setPieData([...res?.data])\r\n        })\r\n    }\r\n\r\n    const initHGData = async () => {\r\n        await req.post('admin/getHistogram',\r\n            { times: [['2020-1', '2020-2'], ['2020-2', '2020-3'], ['2020-3', '2020-4'], ['2020-4', '2020-5'], ['2020-5', '2020-6']] }\r\n        ).then(res => {\r\n            console.log(res);\r\n\r\n            setHGData([...res?.data])\r\n        })\r\n    }\r\n\r\n    useEffect(() => {\r\n        initPieData()\r\n        initHGData()\r\n        // setPieData(\r\n        //     [\r\n        //         { item: '事例一', count: 40, percent: 0.4 },\r\n        //         { item: '事例二', count: 21, percent: 0.21 },\r\n        //         { item: '事例三', count: 17, percent: 0.17 },\r\n        //         { item: '事例四', count: 13, percent: 0.13 },\r\n        //         { item: '事例五', count: 9, percent: 0.09 },\r\n\r\n        //     ]\r\n        // )\r\n        // setHGData(\r\n        //     [\r\n        //         { time: '1951 年', sales: 38 },\r\n        //         { time: '1952 年', sales: 52 },\r\n        //         { time: '1956 年', sales: 61 },\r\n        //         { time: '1957 年', sales: 145 },\r\n        //         { time: '1958 年', sales: 48 },\r\n        //         { time: '1959 年', sales: 38 },\r\n        //         { time: '1960 年', sales: 38 },\r\n        //         { time: '1962 年', sales: 38 },\r\n        //     ]\r\n        // )\r\n    }, [])\r\n    return (\r\n        <div className=\"chart\">\r\n            {pieData.length !== 0 && <PieChart pieData={pieData} />}\r\n            {/* <PieChart pieData={pieData} /> */}\r\n            {histogramData.length !== 0 && <Histogram data={histogramData} />}\r\n        </div>\r\n    );\r\n}\r\n\r\nexport default Chart;","import axios from 'axios'\r\nimport { message, Modal } from 'antd';\r\nconst ConfigBaseURL = 'http://localhost:7000/' //默认路径，这里也可以使用env来判断环境\r\nlet loadingInstance = null //这里是loading\r\n//使用create方法创建axios实例\r\nexport const Service = axios.create({\r\n  timeout: 7000, // 请求超时时间\r\n  baseURL: ConfigBaseURL,\r\n//   method: 'post',\r\n//   headers: {\r\n//     'Content-Type': 'application/json;charset=UTF-8'\r\n//   }\r\n})\r\n// const address = '127.0.0.1/7001'\r\nService.interceptors.request.use(function (config) {\r\n    // Do something before request is sent\r\n    // console.log(config);\r\n\r\n  config.url?.indexOf('/admin/') ?\r\n    config.headers.token = localStorage.getItem('token') :\r\n    config.headers.token = localStorage.getItem('adminToken')\r\n    return config;\r\n  }, function (error) {\r\n    // Do something with request error\r\n    return Promise.reject(error);\r\n  });\r\n\r\n// Add a response interceptor\r\nService.interceptors.response.use(\r\n  res => {\r\n    // res.status === 200 ?\r\n    console.log(res);\r\n    \r\n    if (res.status === 200) {\r\n        if (res.data.status && res.data.status === 401) {\r\n          console.log(res.data.status);\r\n          \r\n         Modal.confirm({\r\n           title: '登录过期',\r\n           content: `登录过期，是否刷新页面并重新登录？`,\r\n           onOk: () => {\r\n             localStorage.removeItem('userInfo')\r\n             localStorage.removeItem('token')\r\n\r\n            //  window.h\r\n             window.location.reload()\r\n                }\r\n              })\r\n        }\r\n        return Promise.resolve(res.data)\r\n      } else {\r\n        return Promise.reject(res)\r\n      }\r\n      \r\n     } \r\n    ,function (error) {\r\n    // Do something with response error\r\n    return Promise.reject(error);\r\n  });\r\nclass Request {\r\n     post = async (url:string, data?:object,) =>{\r\n        try {\r\n            const result = await Service.post(url, data)\r\n            return result\r\n\r\n        } catch (error) {\r\n            \r\n        }\r\n\r\n  }\r\n  \r\n  get = async (url: string) => {\r\n    try {\r\n      const result = await Service.get(url)\r\n      return result\r\n    } catch (error) {\r\n      console.log(error);\r\n      \r\n    }\r\n  }\r\n}\r\n\r\nexport default Request"],"sourceRoot":""}